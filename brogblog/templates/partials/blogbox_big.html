{% load static %}
{% for blog in blogs %}
<a href="{% url 'blog-detail' blog_id=blog.blog_id %}" >
    <div id="{{ blog.blog_id }}_blogbox" class="bg-background-light dark:bg-background-dark border border-slate-200 dark:border-slate-800 rounded-lg overflow-hidden shadow-sm hover:shadow-lg transition-shadow duration-300">

        {% with blog.blogimage_set.all.0 as first_image %}
            {% if first_image and first_image.image_path %}
                <img src = "{{ first_image.image_path.url }}" alt = "{{ blog.blog_id }}_blogimage" 
                class = "w-full max-h-48 object-cover mx-auto"/>
            {% endif %}
        {% endwith %}


        <div class="p-6">
            <!-- <div class="mb-4">
                <span class="text-xs font-semibold uppercase tracking-wider bg-primary/10 text-primary py-1 px-3 rounded-full">Category</span>
            </div> -->

            <h3 class="text-xl font-bold mb-2 text-slate-900 dark:text-white">
                {{ blog.header }}
            </h3>

            <p class="text-slate-600 dark:text-slate-400 mb-4 text-base">
                {{ blog.body|truncatechars:50 }}
            </p>

            <!-- Author + Date -->
            <div class="flex items-center text-sm text-slate-500 dark:text-slate-400 mb-4">
                <div class="w-8 h-8 rounded-full bg-cover bg-center mr-3"
                    style='background-image: url("{% if blog.user.profile_path %}{{ blog.user.profile_path.url }}{% else %}{% static "img/no-img-user.png" %}{% endif %}");'>
                </div>
                <div class="flex items-center gap-1 text-slate-500 dark:text-slate-400">
                    <span class="material-symbols-outlined text-sm">ink_pen</span>
                    <p class="text-sm">{{ blog.user.auth_user.username|truncatechars:10 }}</p>
                </div>
                <span class="mx-2">·</span>
                <span>{{ blog.created_date }}</span>
            </div>

            <!-- Interaction Icons -->
            <div class="flex items-center justify-between text-slate-500 dark:text-slate-400">
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-1">
                        <span class="material-symbols-outlined text-base">favorite</span>
                        <span class="text-xs font-medium">{{ blog.likes }}</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="material-symbols-outlined text-base">chat_bubble</span>
                        <span class="text-xs font-medium">{{ blog.num_comments }}</span>
                    </div>
                    <div class="flex items-center gap-1">
                                <span class="material-symbols-outlined text-base">visibility</span>
                                <span class="text-xs font-medium">{{ blog.views }}</span>
                    </div>
                </div>
                <!-- Bookmark from blog-detail -->
                <button 
                    onclick="MarkBlog(this)" 
                    data-blog-bookmark-id="{{ blog.blog_id }}"
                    class="text-primary flex items-center gap-1 text-sm transition-colors flex-shrink-0"
                    style="color: gray;"> <!-- สี text ปุ่มเริ่มต้นเป็น gray -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M5 5v16l7-5 7 5V5a2 2 0 00-2-2H7a2 2 0 00-2 2z"
                            fill="none" /> <!-- fill เริ่มต้นเป็น none -->
                    </svg>
                    <span class="text-xs font-medium">{{ bookmark_count }}</span>
                </button>
            </div>
        </div>
    </div>
{% endfor %}